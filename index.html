<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ –∫–∞–º–ø—É—Å–∞</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

     <div id="plan-window" class="plan-window">
    <div class="plan-header">
        <button class="plan-close" id="plan-close">&times;</button>
        <h3 id="plan-title">–ü–ª–∞–Ω —ç—Ç–∞–∂–∞</h3>
    </div>
    <div class="plan-content" id="plan-content">
         <div class="plan-svg-container">
            <svg id="plan-svg" viewBox="0 0 1000 800" preserveAspectRatio="xMidYMid meet">
                <!-- SVG —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–ª–∞–Ω–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                <g id="plan-content"></g>
            </svg>
            <div class="plan-controls">
                <button id="plan-zoom-in" title="–£–≤–µ–ª–∏—á–∏—Ç—å">+</button>
                <button id="plan-zoom-out" title="–£–º–µ–Ω—å—à–∏—Ç—å">-</button>
                <button id="plan-reset" title="–°–±—Ä–æ—Å–∏—Ç—å –≤–∏–¥">‚ü≤</button>
            </div>
        </div>
        <div class="plan-placeholder">
            <div class="plan-icon">üè¢</div>
            <p>–ü–ª–∞–Ω —ç—Ç–∞–∂–∞ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω –∑–¥–µ—Å—å</p>
            <small>–í—ã–±–µ—Ä–∏—Ç–µ —ç—Ç–∞–∂ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –ø–ª–∞–Ω"</small>
        </div>
    </div>
</div>
  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="main-content" id="main-content">
        <div class="container">
            <h1>–ö–∞—Ä—Ç–∞ –Æ–∂–Ω–æ–≥–æ –ö–∞–º–ø—É—Å–∞</h1>
            
            <div class="search-container">
                <select id="building-select" class="building-select">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—Ä–ø—É—Å...</option>
                </select>
            </div>

            <div class="map-container">
                <div id="map">
                    <!-- SVG –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <button class="sidebar-close" id="sidebar-close">&times;</button>
            <h2 id="building-title">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–¥–∞–Ω–∏—è</h2>
            <p id="building-description">–û–ø–∏—Å–∞–Ω–∏–µ –∑–¥–∞–Ω–∏—è</p>
        </div>
        
        <div class="sidebar-content">
            <div class="floor-selection">
                <h3>–í—ã–±–µ—Ä–∏—Ç–µ —ç—Ç–∞–∂:</h3>
                <div class="floor-buttons" id="floor-buttons"></div>
                <!-- –î–û–ë–ê–í–¨–¢–ï –≠–¢–û–¢ –ë–õ–û–ö -->
                <div class="plan-button-section">
                <button class="show-plan-btn" id="show-plan-btn">
                    üó∫Ô∏è –ü–æ–∫–∞–∑–∞—Ç—å –ø–ª–∞–Ω —ç—Ç–∞–∂–∞
                </button>
            </div>
        </div>
            </div>
            
            <div class="classrooms-section">
                <div class="section-header">
                    <h3>–ê—É–¥–∏—Ç–æ—Ä–∏–∏ —ç—Ç–∞–∂–∞</h3>
                    <span class="classrooms-count" id="classrooms-count">0 –∞—É–¥–∏—Ç–æ—Ä–∏–π</span>
                </div>
                <div class="classrooms-list" id="classrooms-list"></div>
            </div>
            
            <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—É–¥–∏—Ç–æ—Ä–∏–∏ -->
            <div class="classroom-details" id="classroom-details">
                <div class="classroom-details-header">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—É–¥–∏—Ç–æ—Ä–∏–∏</h3>
                    <button class="close-details">&times;</button>
                </div>
                <div class="classroom-details-content">
                    <div class="classroom-main-info">
                        <span class="classroom-details-number" id="classroom-number">-</span>
                        <span class="classroom-details-name" id="classroom-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏</span>
                    </div>
                    <div class="classroom-additional-info">
                        <p class="classroom-type-badge" id="classroom-type">–¢–∏–ø</p>
                        <p class="classroom-description" id="classroom-description">–û–ø–∏—Å–∞–Ω–∏–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="data/buildings-info.js"></script>
    <script src="data/classrooms-3Ablock.js"></script>
    <script src="data/classrooms-18block.js"></script>
    <script src="data/data-manager.js"></script>
    <script src="map-core.js"></script>
    <script src="ui-controls.js"></script>
    <script src="search.js"></script>
    <script src="app.js"></script>

    <script>
// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–º —ç—Ç–∞–∂–∞
class PlanManager {
    constructor() {
        this.planWindow = document.querySelector('.plan-window');
        this.svg = document.querySelector('#plan-svg');
        this.planContent = document.querySelector('#plan-content');
        this.zoomInBtn = document.querySelector('#plan-zoom-in');
        this.zoomOutBtn = document.querySelector('#plan-zoom-out');
        this.resetBtn = document.querySelector('#plan-reset');
        
        this.currentScale = 1;
        this.minScale = 0.3;
        this.maxScale = 3;
        this.scaleStep = 0.2;
        
        this.isDragging = false;
        this.startX = 0;
        this.startY = 0;
        this.translateX = 0;
        this.translateY = 0;
        
        this.currentFloor = 1;
        this.selectedRoom = null;
        
        this.init();
    }
    
    init() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        this.zoomInBtn.addEventListener('click', () => this.zoomIn());
        this.zoomOutBtn.addEventListener('click', () => this.zoomOut());
        this.resetBtn.addEventListener('click', () => this.resetView());
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –ø–ª–∞–Ω–∞
        this.svg.addEventListener('mousedown', (e) => this.startDrag(e));
        this.svg.addEventListener('mousemove', (e) => this.drag(e));
        this.svg.addEventListener('mouseup', () => this.endDrag());
        this.svg.addEventListener('mouseleave', () => this.endDrag());
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
        this.svg.addEventListener('contextmenu', (e) => e.preventDefault());
        
        this.resetView();
    }
    
    startDrag(e) {
        if (e.button !== 0) return; // —Ç–æ–ª—å–∫–æ –ª–µ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –º—ã—à–∏
        e.preventDefault();
        this.isDragging = true;
        
        const rect = this.svg.getBoundingClientRect();
        this.startX = e.clientX - this.translateX;
        this.startY = e.clientY - this.translateY;
        
        this.svg.style.cursor = 'grabbing';
    }
    
    drag(e) {
        if (!this.isDragging) return;
        e.preventDefault();
        
        this.translateX = e.clientX - this.startX;
        this.translateY = e.clientY - this.startY;
        
        this.updateTransform();
    }
    
    endDrag() {
        this.isDragging = false;
        this.svg.style.cursor = 'grab';
    }
    
    zoomIn() {
        if (this.currentScale < this.maxScale) {
            this.currentScale = Math.min(this.maxScale, this.currentScale + this.scaleStep);
            this.updateTransform();
        }
    }
    
    zoomOut() {
        if (this.currentScale > this.minScale) {
            this.currentScale = Math.max(this.minScale, this.currentScale - this.scaleStep);
            this.updateTransform();
        }
    }
    
    resetView() {
        this.currentScale = 1;
        this.translateX = 0;
        this.translateY = 0;
        this.updateTransform();
    }
    
    updateTransform() {
        this.planContent.setAttribute('transform', 
            `translate(${this.translateX}, ${this.translateY}) scale(${this.currentScale})`
        );
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞–Ω–∞ —ç—Ç–∞–∂–∞
    loadFloorPlan(floorNumber) {
        // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–ª–∞–Ω
        this.planContent.innerHTML = '';
        this.currentFloor = floorNumber;
        
        // –°–æ–∑–¥–∞–µ–º –ø–ª–∞–Ω –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç—Ç–∞–∂–∞
        this.createFloorPlan(floorNumber);
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤–∏–¥ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–≥–æ –ø–ª–∞–Ω–∞
        this.resetView();
        
        // –ï—Å–ª–∏ –µ—Å—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è, –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –µ—ë –Ω–∞ –ø–ª–∞–Ω–µ
        this.highlightSelectedClassroom();
    }
    
    createFloorPlan(floorNumber) {
        const rooms = this.getRoomsForFloor(floorNumber);
        
        rooms.forEach(room => {
            const roomGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            roomGroup.classList.add('plan-room');
            roomGroup.setAttribute('data-room-id', room.id);
            roomGroup.setAttribute('data-room-number', room.number);
            
            // –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –∫–æ–º–Ω–∞—Ç—ã
            const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            rect.setAttribute('x', room.x);
            rect.setAttribute('y', room.y);
            rect.setAttribute('width', room.width);
            rect.setAttribute('height', room.height);
            rect.setAttribute('fill', room.color);
            rect.setAttribute('stroke', '#333');
            rect.setAttribute('stroke-width', '2');
            rect.setAttribute('rx', '5');
            
            // –¢–µ–∫—Å—Ç —Å –Ω–æ–º–µ—Ä–æ–º –∫–æ–º–Ω–∞—Ç—ã
            const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            text.setAttribute('x', room.x + room.width / 2);
            text.setAttribute('y', room.y + room.height / 2);
            text.setAttribute('text-anchor', 'middle');
            text.setAttribute('dominant-baseline', 'middle');
            text.setAttribute('fill', 'white');
            text.setAttribute('font-weight', 'bold');
            text.setAttribute('font-size', '14');
            text.textContent = room.number;
            
            roomGroup.appendChild(rect);
            roomGroup.appendChild(text);
            this.planContent.appendChild(roomGroup);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–æ–º–Ω–∞—Ç
            roomGroup.addEventListener('click', (e) => {
                e.stopPropagation();
                this.onRoomSelect(room.id, room.number);
            });
            
            roomGroup.style.cursor = 'pointer';
        });
    }
    
    getRoomsForFloor(floorNumber) {
        // –ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–∂–µ–π
        const floorPlans = {
            1: [
                { id: 'room-101', x: 100, y: 100, width: 120, height: 80, number: '101', color: '#4CAF50', type: 'lecture' },
                { id: 'room-102', x: 250, y: 100, width: 120, height: 80, number: '102', color: '#2196F3', type: 'seminar' },
                { id: 'room-103', x: 400, y: 100, width: 120, height: 80, number: '103', color: '#FF9800', type: 'lab' },
                { id: 'room-104', x: 100, y: 220, width: 120, height: 80, number: '104', color: '#9C27B0', type: 'computer' },
                { id: 'room-105', x: 250, y: 220, width: 120, height: 80, number: '105', color: '#795548', type: 'office' }
            ],
            2: [
                { id: 'room-201', x: 100, y: 100, width: 120, height: 80, number: '201', color: '#4CAF50', type: 'lecture' },
                { id: 'room-202', x: 250, y: 100, width: 120, height: 80, number: '202', color: '#2196F3', type: 'seminar' },
                { id: 'room-203', x: 400, y: 100, width: 120, height: 80, number: '203', color: '#FF9800', type: 'lab' },
                { id: 'room-204', x: 100, y: 220, width: 120, height: 80, number: '204', color: '#9C27B0', type: 'computer' }
            ],
            3: [
                { id: 'room-301', x: 100, y: 100, width: 150, height: 100, number: '301', color: '#4CAF50', type: 'lecture' },
                { id: 'room-302', x: 280, y: 100, width: 150, height: 100, number: '302', color: '#2196F3', type: 'seminar' },
                { id: 'room-303', x: 100, y: 240, width: 150, height: 100, number: '303', color: '#FF9800', type: 'lab' }
            ]
        };
        
        return floorPlans[floorNumber] || floorPlans[1];
    }
    
    onRoomSelect(roomId, roomNumber) {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ–º–Ω–∞—Ç—É
        this.selectedRoom = { id: roomId, number: roomNumber };
        
        // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–æ–º–Ω–∞—Ç—É –Ω–∞ –ø–ª–∞–Ω–µ
        this.highlightRoomOnPlan(roomId);
        
        // –ù–∞—Ö–æ–¥–∏–º –∏ –≤—ã–¥–µ–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é –≤ —Å–ø–∏—Å–∫–µ
        this.selectClassroomInList(roomNumber);
    }
    
    highlightRoomOnPlan(roomId) {
        // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Å–æ –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç
        this.clearRoomHighlights();
        
        // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ–º–Ω–∞—Ç—É
        const selectedRoom = this.planContent.querySelector(`[data-room-id="${roomId}"]`);
        if (selectedRoom) {
            selectedRoom.classList.add('plan-room-highlighted');
        }
    }
    
    clearRoomHighlights() {
        const allRooms = this.planContent.querySelectorAll('.plan-room');
        allRooms.forEach(room => {
            room.classList.remove('plan-room-highlighted');
        });
    }
    
    selectClassroomInList(roomNumber) {
        // –ù–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –Ω–æ–º–µ—Ä–æ–º –∞—É–¥–∏—Ç–æ—Ä–∏–∏
        const classroomItems = document.querySelectorAll('.classroom-item');
        let found = false;
        
        classroomItems.forEach(item => {
            const numberElement = item.querySelector('.classroom-number');
            if (numberElement && numberElement.textContent.trim() === roomNumber.trim()) {
                // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                classroomItems.forEach(i => i.classList.remove('selected'));
                // –í—ã–¥–µ–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
                item.classList.add('selected');
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
                item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                found = true;
            }
        });
        
        if (!found) {
            console.log('–ê—É–¥–∏—Ç–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ —Å–ø–∏—Å–∫–µ:', roomNumber);
        }
    }
    
    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–æ–º–Ω–∞—Ç—ã –Ω–∞ –ø–ª–∞–Ω–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏–∑ —Å–ø–∏—Å–∫–∞
    highlightRoomOnPlanByNumber(roomNumber) {
        // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Å–æ –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç
        this.clearRoomHighlights();
        
        // –ò—â–µ–º –∫–æ–º–Ω–∞—Ç—É –ø–æ –Ω–æ–º–µ—Ä—É
        const allRooms = this.planContent.querySelectorAll('.plan-room');
        let found = false;
        
        allRooms.forEach(room => {
            const roomNumberAttr = room.getAttribute('data-room-number');
            if (roomNumberAttr && roomNumberAttr.trim() === roomNumber.trim()) {
                room.classList.add('plan-room-highlighted');
                this.selectedRoom = { 
                    id: room.getAttribute('data-room-id'), 
                    number: roomNumber 
                };
                found = true;
                
                // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –≤–∏–¥ –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                this.centerOnRoom(room);
            }
        });
        
        if (!found) {
            console.log('–ö–æ–º–Ω–∞—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ –ø–ª–∞–Ω–µ:', roomNumber);
        }
    }
    
    centerOnRoom(roomElement) {
        const rect = roomElement.querySelector('rect');
        if (!rect) return;
        
        const x = parseFloat(rect.getAttribute('x'));
        const y = parseFloat(rect.getAttribute('y'));
        const width = parseFloat(rect.getAttribute('width'));
        const height = parseFloat(rect.getAttribute('height'));
        
        const centerX = x + width / 2;
        const centerY = y + height / 2;
        
        // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –≤–∏–¥ –Ω–∞ –∫–æ–º–Ω–∞—Ç–µ
        const svgRect = this.svg.getBoundingClientRect();
        this.translateX = -centerX * this.currentScale + svgRect.width / 2;
        this.translateY = -centerY * this.currentScale + svgRect.height / 2;
        
        this.updateTransform();
    }
    
    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–ª–∞–Ω–∞
    highlightSelectedClassroom() {
        const selectedClassroom = document.querySelector('.classroom-item.selected');
        if (selectedClassroom) {
            const numberElement = selectedClassroom.querySelector('.classroom-number');
            if (numberElement) {
                const roomNumber = numberElement.textContent.trim();
                this.highlightRoomOnPlanByNumber(roomNumber);
            }
        }
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    const planManager = new PlanManager();
    
    // –î–æ–±–∞–≤–ª—è–µ–º SVG —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏
    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
    const filter = document.createElementNS('http://www.w3.org/2000/svg', 'filter');
    filter.setAttribute('id', 'glow');
    filter.setAttribute('x', '-100%');
    filter.setAttribute('y', '-100%');
    filter.setAttribute('width', '300%');
    filter.setAttribute('height', '300%');
    
    const feGaussianBlur = document.createElementNS('http://www.w3.org/2000/svg', 'feGaussianBlur');
    feGaussianBlur.setAttribute('in', 'SourceGraphic');
    feGaussianBlur.setAttribute('stdDeviation', '4');
    feGaussianBlur.setAttribute('result', 'blur');
    
    const feColorMatrix = document.createElementNS('http://www.w3.org/2000/svg', 'feColorMatrix');
    feColorMatrix.setAttribute('in', 'blur');
    feColorMatrix.setAttribute('type', 'matrix');
    feColorMatrix.setAttribute('values', '1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -8');
    feColorMatrix.setAttribute('result', 'glow');
    
    const feMerge = document.createElementNS('http://www.w3.org/2000/svg', 'feMerge');
    const feMergeNode1 = document.createElementNS('http://www.w3.org/2000/svg', 'feMergeNode');
    feMergeNode1.setAttribute('in', 'glow');
    const feMergeNode2 = document.createElementNS('http://www.w3.org/2000/svg', 'feMergeNode');
    feMergeNode2.setAttribute('in', 'SourceGraphic');
    
    feMerge.appendChild(feMergeNode1);
    feMerge.appendChild(feMergeNode2);
    filter.appendChild(feGaussianBlur);
    filter.appendChild(feColorMatrix);
    filter.appendChild(feMerge);
    defs.appendChild(filter);
    document.querySelector('#plan-svg').appendChild(defs);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –ø–ª–∞–Ω–∞
    const showPlanBtn = document.querySelector('.show-plan-btn');
    const planCloseBtn = document.querySelector('.plan-close');
    
    showPlanBtn.addEventListener('click', function() {
        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç—Ç–∞–∂
        const activeFloorBtn = document.querySelector('.floor-btn.active');
        let currentFloor = 1;
        if (activeFloorBtn) {
            currentFloor = parseInt(activeFloorBtn.getAttribute('data-floor')) || 1;
        }
        
        planManager.planWindow.classList.add('open');
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–ª–∞–Ω –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —ç—Ç–∞–∂–∞
        planManager.loadFloorPlan(currentFloor);
    });
    
    planCloseBtn.addEventListener('click', function() {
        planManager.planWindow.classList.remove('open');
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–ª–∞–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
    planManager.planWindow.addEventListener('click', function(e) {
        if (e.target === planManager.planWindow) {
            planManager.planWindow.classList.remove('open');
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —ç—Ç–∞–∂–∞
    document.querySelectorAll('.floor-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const floor = parseInt(this.getAttribute('data-floor')) || 1;
            
            // –ï—Å–ª–∏ –ø–ª–∞–Ω –æ—Ç–∫—Ä—ã—Ç, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
            if (planManager.planWindow.classList.contains('open')) {
                planManager.loadFloorPlan(floor);
            }
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –≤ —Å–ø–∏—Å–∫–µ - –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞ –ø–ª–∞–Ω–µ
    document.addEventListener('click', function(e) {
        const classroomItem = e.target.closest('.classroom-item');
        if (classroomItem) {
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.classroom-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —ç–ª–µ–º–µ–Ω—Ç
            classroomItem.classList.add('selected');
            
            const numberElement = classroomItem.querySelector('.classroom-number');
            if (numberElement) {
                const roomNumber = numberElement.textContent;
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–æ–º–Ω–∞—Ç—É –Ω–∞ –ø–ª–∞–Ω–µ, –µ—Å–ª–∏ –ø–ª–∞–Ω –æ—Ç–∫—Ä—ã—Ç
                if (planManager.planWindow.classList.contains('open')) {
                    planManager.highlightRoomOnPlanByNumber(roomNumber);
                }
            }
        }
    });
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ —ç—Ç–∞–∂–µ–π
    document.querySelectorAll('.floor-btn').forEach((btn, index) => {
        if (!btn.getAttribute('data-floor')) {
            btn.setAttribute('data-floor', (index + 1).toString());
        }
    });
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–ø–∏—Å–æ–∫ –∞—É–¥–∏—Ç–æ—Ä–∏–π
    const classroomsList = document.querySelector('.classrooms-list');
    if (classroomsList && classroomsList.children.length === 0) {
        const testClassrooms = [
            { number: '101', name: '–õ–µ–∫—Ü–∏–æ–Ω–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è', type: 'lecture' },
            { number: '102', name: '–°–µ–º–∏–Ω–∞—Ä—Å–∫–∞—è –∫–æ–º–Ω–∞—Ç–∞', type: 'seminar' },
            { number: '103', name: '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è —Ñ–∏–∑–∏–∫–∏', type: 'lab' },
            { number: '104', name: '–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π –∫–ª–∞—Å—Å', type: 'computer' },
            { number: '105', name: '–ö–∞–±–∏–Ω–µ—Ç –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π', type: 'office' },
            { number: '201', name: '–ë–æ–ª—å—à–∞—è –ª–µ–∫—Ü–∏–æ–Ω–Ω–∞—è', type: 'lecture' },
            { number: '202', name: '–°–µ–º–∏–Ω–∞—Ä—Å–∫–∞—è 202', type: 'seminar' },
            { number: '203', name: '–•–∏–º–∏—á–µ—Å–∫–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è', type: 'lab' },
            { number: '204', name: '–ò–¢ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è', type: 'computer' },
            { number: '301', name: '–ê–∫—Ç–æ–≤—ã–π –∑–∞–ª', type: 'lecture' },
            { number: '302', name: '–ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü-–∑–∞–ª', type: 'seminar' },
            { number: '303', name: '–ù–∞—É—á–Ω–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è', type: 'lab' }
        ];
        
        testClassrooms.forEach(classroom => {
            const item = document.createElement('div');
            item.className = 'classroom-item';
            item.innerHTML = `
                <div class="classroom-info">
                    <div class="classroom-number">${classroom.number}</div>
                    <div class="classroom-name">${classroom.name}</div>
                    <div class="classroom-type ${classroom.type}">${classroom.type}</div>
                </div>
            `;
            classroomsList.appendChild(item);
        });
    }
});
</script>
</body>
</html>